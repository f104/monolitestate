jQuery(function(){"use strict";function a(){if($("#map").length&&"object"==typeof app.mapData){try{app.mapData.object.geo=JSON.parse(app.mapData.object.geo)}catch(a){console.log(a)}var s=new ymaps.Map("map",{center:app.mapData.object.geo[0],zoom:13,controls:[]});s.behaviors.disable("scrollZoom");for(var a=ymaps.templateLayoutFactory.createClass('<div class="placemark {{ properties.className }}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8.202 11.113" class=""><path d="M4.101 11.113c2.734-3.12 4.101-5.442 4.101-6.968C8.202 1.855 6.366 0 4.101 0 1.836 0 0 1.856 0 4.145c0 1.526 1.367 3.849 4.101 6.968z" fill="#fff"></path></svg><span>{{ properties.content }}</span></div>'),e=ymaps.templateLayoutFactory.createClass('<div class="placemark _{{ properties.className }}">\n                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8.202 11.113" class=""><path d="M4.101 11.113c2.734-3.12 4.101-5.442 4.101-6.968C8.202 1.855 6.366 0 4.101 0 1.836 0 0 1.856 0 4.145c0 1.526 1.367 3.849 4.101 6.968z" fill="#fff"></path></svg>\n                <span><i class="icon-{{ properties.className }}"></i></span>\n            </div>'),o=ymaps.templateLayoutFactory.createClass('<div class="map__balloon {% if properties.logo %}_logo{% endif %}">\n                    {% if properties.logo %}<span class="map__balloon__logo"><img src="{{ properties.logo }}"></span>{% endif %}\n                    <span class="map__balloon__content">\n                        <span class="map__balloon__title">{{ properties.title }}</span>\n                        <span class="map__balloon__address">{{ properties.address }}</span>\n                    </span>\n                </div>'),t=0,n=app.mapData.object.geo.length;t<n;t++){var p=new ymaps.Placemark(app.mapData.object.geo[t],{className:"_dot _primary _object",title:app.mapData.object.title,address:app.mapData.object.address},{iconLayout:a,iconShape:{type:"Rectangle",coordinates:[[-15.5,-42],[15.5,0]]},hideIconOnBalloonOpen:!1,balloonLayout:o,balloonCloseButton:!1});s.geoObjects.add(p)}try{app.mapData.infrastructure=JSON.parse(app.mapData.infrastructure)}catch(a){console.log(a)}t=0;var r=app.mapData.infrastructure;for(n=r.length;t<n;t++){p=new ymaps.Placemark(r[t].geo,{type:r[t].type,className:r[t].icon,title:r[t].title,address:r[t].address,logo:r[t].logo||null},{iconLayout:e,iconShape:{type:"Rectangle",coordinates:[[-15.5,-42],[15.5,0]]},hideIconOnBalloonOpen:!1,balloonLayout:o,balloonCloseButton:!1});s.geoObjects.add(p)}$(".js-infrastructure__legend__list input").on("change",function(){!function(){for(var a=0,e=s.geoObjects.getLength();a<e;a++){var o=s.geoObjects.get(a);o.balloon.close()}}();var o=$(this).data("type"),t=$(this).prop("checked");s.geoObjects.each(function(a,e){a.properties.get("type")==o&&a.options.set("visible",t)})}),1<s.geoObjects.getLength()&&s.setBounds(s.geoObjects.getBounds()),0==s.getZoom()&&s.setZoom(13),s.geoObjects.get(0).balloon.open(),$(".js-map__zoom").on("click",function(){var a=s.getZoom();$(this).hasClass("_in")?a++:a--,s.setZoom(a,{checkZoomRange:!0,duration:200})})}}$(document).ready(function(){$(".js-infrastructure__legend__toggler").on("click",function(a){a.preventDefault();var e=$(this),o=$(".js-infrastructure__legend__list");e.toggleClass("_active"),o.slideToggle(),e.text(e.hasClass("_active")?"Показать легенду":"Скрыть легенду")}),function(){if(void 0===typeof panellum)return;$(".js-panorama-gallery-nav").slick({dots:!1,arrows:!0,infinite:!1,slidesToShow:6,slidesToScroll:1,focusOnSelect:!0,asNavFor:".js-panorama-gallery__slider",responsive:[{breakpoint:appConfig.breakpoint.md,settings:{slidesToShow:3}}]}),$(".js-panorama-gallery").each(function(a,e){var o=$(e).find(".js-panorama-gallery__slider");o.slick({dots:!1,arrows:!0,infinite:!1,swipeToSlide:!0,swipe:!1,draggable:!1,asNavFor:".js-panorama-gallery-nav",responsive:[{breakpoint:appConfig.breakpoint.md,settings:{arrows:!1}}]})});$(".js-panorama").each(function(){var a=$(this).data("panorama");if(a){var e=pannellum.viewer(this,{type:"equirectangular",panorama:a,hfov:120,autoLoad:!0}),o=$(this).parents(".js-tabs");o.length&&o.bind("easytabs:after",function(){e.getRenderer().resize(),e.setYaw(e.getYaw())})}})}(),ymaps.ready(a)})});